import{l as K,u as E,c as b,S as k,R,r as A,j as e}from"./index-CkvKbGHG.js";import{W as z}from"./WeatherWidget-C5cKMd7B.js";import"./vendor-CMJYdXG8.js";const S={[b.Hereford]:{min:.8,avg:1.1,max:1.4},[b.Braford]:{min:.9,avg:1.2,max:1.5},[b.HerefordPO]:{min:.85,avg:1.15,max:1.45},[b.Outros]:{min:.7,avg:1,max:1.3}},H={[k.Macho]:1.1,[k.Femea]:.95},G=s=>s<=6?1.2:s<=12?1.1:s<=18?1:s<=24?.9:s<=36?.75:.5,L=(s,x)=>{const f=new Date,d=Math.ceil((x.getTime()-f.getTime())/(1e3*60*60*24));if(d<=0)return{animalId:s.id,currentWeight:s.pesoKg,predictedWeight:s.pesoKg,targetDate:x,confidence:100,basedOnDays:0,projectedGMD:0};const l=K(s),g=E(s.dataNascimento),c=S[s.raca]||S[b.Outros],y=H[s.sexo],p=G(g);let o,n;if(l.gmdTotal&&l.gmdTotal>0&&l.diasAcompanhamento&&l.diasAcompanhamento>=30){const h=g+Math.floor(d/30),N=G(h);o=l.gmdTotal*(N/p),n=Math.min(90,50+l.diasAcompanhamento/3)}else o=c.avg*y*p,n=40;o=Math.max(.3,Math.min(2,o));const w=Math.round(s.pesoKg+o*d);return d>180?n*=.7:d>90?n*=.85:d>30&&(n*=.95),{animalId:s.id,currentWeight:s.pesoKg,predictedWeight:Math.max(s.pesoKg,w),targetDate:x,confidence:Math.round(n),basedOnDays:l.diasAcompanhamento||0,projectedGMD:Number(o.toFixed(3))}},I=(s,x)=>s.map(f=>L(f,x)),X=({stats:s,enabledWidgets:x,areas:f,compactMode:d=!1,calendarEvents:l=[],tasks:g=[],animals:c=[]})=>{const y=t=>{if(d)return"col-span-1";switch(t){case"small":return"col-span-1";case"medium":return"col-span-1 md:col-span-2";case"large":return"col-span-1 md:col-span-2 lg:col-span-3"}},p=R.useMemo(()=>{const t=new Date,r=new Date(t.getTime()+10080*60*1e3);return l.filter(u=>{const m=new Date(u.date);return m>=t&&m<=r}).sort((u,m)=>new Date(u.date).getTime()-new Date(m.date).getTime()).slice(0,5)},[l]),o=R.useMemo(()=>g.filter(t=>!t.isCompleted).sort((t,r)=>t.dueDate?r.dueDate?new Date(t.dueDate).getTime()-new Date(r.dueDate).getTime():-1:1).slice(0,5),[g]),n=A.useMemo(()=>{const t=new Date;return t.setMonth(t.getMonth()+3),t},[]),w=A.useMemo(()=>!c||c.length===0?"":c.map(t=>{var r;return`${t.id}:${t.pesoKg}:${((r=t.historicoPesagens)==null?void 0:r.length)||0}`}).sort().join("|"),[c]),h=A.useMemo(()=>I(c,n),[w,n]),N=h.length?h.reduce((t,r)=>t+r.predictedWeight,0)/h.length:null,j=h[0],T=t=>new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),P=t=>{var r,u,m;switch(t.type){case"breed-distribution":return e.jsxs("div",{className:"space-y-2",children:[Object.entries(s.breedDistribution).map(([a,v])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-base-700 rounded-full h-2",children:e.jsx("div",{className:"bg-brand-primary h-2 rounded-full",style:{width:`${v/s.totalAnimals*100}%`}})}),e.jsx("span",{className:"text-sm font-medium w-8",children:v})]})]},a)),Object.keys(s.breedDistribution).length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Sem dados"})]});case"sex-distribution":const $=s.totalAnimals>0?s.maleCount/s.totalAnimals*100:0;return e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:s.maleCount}),e.jsx("div",{className:"text-xs text-gray-400",children:"Machos"})]}),e.jsx("div",{className:"w-20 h-20 relative",children:e.jsxs("svg",{viewBox:"0 0 36 36",className:"w-full h-full",children:[e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#4a5568",strokeWidth:"3"}),e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#60a5fa",strokeWidth:"3",strokeDasharray:`${$}, 100`})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-pink-400",children:s.femaleCount}),e.jsx("div",{className:"text-xs text-gray-400",children:"FÃªmeas"})]})]});case"age-distribution":const C=[{label:"Bezerros (0-6m)",value:s.ageDistribution.bezerros,color:"bg-green-500"},{label:"Jovens (6-12m)",value:s.ageDistribution.jovens,color:"bg-yellow-500"},{label:"Novilhos (12-24m)",value:s.ageDistribution.novilhos,color:"bg-orange-500"},{label:"Adultos (24m+)",value:s.ageDistribution.adultos,color:"bg-red-500"}];return e.jsx("div",{className:"space-y-2",children:C.map(a=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:a.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-base-700 rounded-full h-2",children:e.jsx("div",{className:`${a.color} h-2 rounded-full`,style:{width:`${s.activeCount>0?a.value/s.activeCount*100:0}%`}})}),e.jsx("span",{className:"text-sm font-medium w-8",children:a.value})]})]},a.label))});case"weight-chart":const O=[{label:"Leve (<200kg)",value:s.weightRangeDistribution.leve},{label:"MÃ©dio (200-400kg)",value:s.weightRangeDistribution.medio},{label:"Pesado (>400kg)",value:s.weightRangeDistribution.pesado}];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-brand-primary",children:[s.averageWeight.toFixed(1)," kg"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Peso MÃ©dio"})]}),O.map(a=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:a.label}),e.jsx("span",{className:"text-sm font-medium",children:a.value})]},a.label))]});case"area-distribution":return e.jsxs("div",{className:"space-y-2",children:[Object.entries(s.areaDistribution).map(([a,v])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300 truncate",children:a}),e.jsx("span",{className:"text-sm font-medium",children:v})]},a)),Object.keys(s.areaDistribution).length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Sem dados"})]});case"health-summary":return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Total de Tratamentos"}),e.jsx("span",{className:"font-medium",children:s.healthStats.totalTreatments})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Animais Tratados"}),e.jsx("span",{className:"font-medium",children:s.healthStats.animalsWithTreatments})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Medicamento Mais Usado"}),e.jsx("span",{className:"font-medium text-brand-primary truncate ml-2",children:s.healthStats.mostUsedMedication})]})]});case"calendar-preview":return e.jsx("div",{className:"space-y-2",children:p.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"Nenhum evento nos prÃ³ximos 7 dias"}):p.map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-base-700/50 rounded",children:[e.jsx("div",{className:"text-xs text-brand-primary-light font-medium min-w-[50px]",children:T(a.date)}),e.jsxs("div",{className:"flex-1 truncate",children:[e.jsx("span",{className:"text-sm text-white",children:a.title}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",a.type,")"]})]})]},a.id))});case"tasks-preview":return e.jsx("div",{className:"space-y-2",children:o.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"Nenhuma tarefa pendente"}):o.map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-base-700/50 rounded",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),e.jsx("div",{className:"flex-1 truncate text-sm text-white",children:a.description}),a.dueDate&&e.jsx("div",{className:"text-xs text-gray-400",children:T(a.dueDate)})]},a.id))});case"weight-evolution":const B=s.totalWeight||0,D=((r=s.weightRangeDistribution)==null?void 0:r.pesado)||0,M=((u=s.weightRangeDistribution)==null?void 0:u.medio)||0,W=((m=s.weightRangeDistribution)==null?void 0:m.leve)||0,i=s.gmdStats,F=!!i&&i.animalsWithGMD>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center p-3 bg-gradient-to-r from-green-900/30 to-blue-900/30 rounded-lg border border-green-700/30",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:[i==null?void 0:i.averageGMD.toFixed(3)," kg/dia"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["GMD MÃ©dio (",i==null?void 0:i.animalsWithGMD," animais)"]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-2",children:[e.jsxs("span",{className:"text-xs text-green-400",children:["ðŸš€ ",i==null?void 0:i.topPerformers," top"]}),e.jsxs("span",{className:"text-xs text-red-400",children:["âš ï¸ ",i==null?void 0:i.underperformers," baixo"]})]})]}):e.jsx("div",{className:"text-sm text-gray-300",children:"Sem dados de GMD para os animais filtrados"})}),e.jsxs("div",{className:"text-center p-3 bg-base-700/50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-brand-primary",children:[(B/1e3).toFixed(1)," t"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Peso Total do Rebanho"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 w-16",children:"Pesados"}),e.jsx("div",{className:"flex-1 bg-base-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full rounded-full flex items-center justify-end pr-2",style:{width:`${s.totalAnimals>0?D/s.totalAnimals*100:0}%`,minWidth:D>0?"30px":"0"},children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:D})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 w-16",children:"MÃ©dios"}),e.jsx("div",{className:"flex-1 bg-base-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"bg-yellow-500 h-full rounded-full flex items-center justify-end pr-2",style:{width:`${s.totalAnimals>0?M/s.totalAnimals*100:0}%`,minWidth:M>0?"30px":"0"},children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:M})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 w-16",children:"Leves"}),e.jsx("div",{className:"flex-1 bg-base-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"bg-red-500 h-full rounded-full flex items-center justify-end pr-2",style:{width:`${s.totalAnimals>0?W/s.totalAnimals*100:0}%`,minWidth:W>0?"30px":"0"},children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:W})})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-base-700",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"GMD MÃ©dio (animais filtrados)"}),e.jsx("span",{className:"text-lg font-bold text-white",children:F?`${i==null?void 0:i.averageGMD.toFixed(3)} kg/dia`:"â€”"})]}),e.jsxs("div",{className:"mt-3 p-3 rounded-lg border border-blue-800/50 bg-blue-900/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"PrevisÃ£o de Peso (prÃ³ximos 3 meses)"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Baseado nos ",c.length," animais filtrados"]})]}),e.jsx("span",{className:"text-xs text-blue-300",children:n.toLocaleDateString("pt-BR")})]}),N?e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:[N.toFixed(1)," kg"]}),j&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Top projeÃ§Ã£o: ",e.jsxs("span",{className:"text-blue-300",children:[j.predictedWeight," kg"]})]})]}),e.jsxs("div",{className:"text-right text-xs text-gray-400",children:[e.jsx("p",{children:"GMD projetado"}),e.jsxs("p",{className:"text-white font-semibold",children:[(j==null?void 0:j.projectedGMD.toFixed(3))??"-"," kg/dia"]})]})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Sem dados suficientes para projetar"})]})]});case"weather":return e.jsx(z,{animals:c});default:return e.jsx("p",{className:"text-gray-500 text-sm",children:"Widget nÃ£o implementado"})}};return e.jsxs("div",{className:`grid gap-4 mb-6 ${d?"grid-cols-2 md:grid-cols-4":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:[e.jsxs("div",{className:"bg-base-800 rounded-lg p-4 border-l-4 border-brand-primary",children:[e.jsx("div",{className:"text-2xl font-bold",children:s.totalAnimals}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total Filtrado"})]}),e.jsxs("div",{className:"bg-base-800 rounded-lg p-4 border-l-4 border-blue-500",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.averageWeight.toFixed(1)," kg"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Peso MÃ©dio"})]}),x.map(t=>e.jsxs("div",{className:`bg-base-800 rounded-lg p-4 ${y(t.size)}`,children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:t.title}),P(t)]},t.id))]})};export{X as default};
