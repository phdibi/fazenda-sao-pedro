import{r as n,j as e,h as j}from"./index-OnCL7RT-.js";import{B as l}from"./calendar-sEluIg52.js";import"./vendor-CMJYdXG8.js";const D=({batches:o,animals:d,onCreateBatch:y,onUpdateBatch:B,onDeleteBatch:N,onCompleteBatch:g})=>{const[f,c]=n.useState(!1),[a,x]=n.useState(null),[r,i]=n.useState({name:"",description:"",purpose:l.Pesagem,animalIds:[]}),[m,v]=n.useState(""),h=n.useMemo(()=>o.filter(s=>s.status==="active"),[o]),u=n.useMemo(()=>o.filter(s=>s.status==="completed").slice(0,5),[o]),w=n.useMemo(()=>{if(!m)return d.slice(0,50);const s=m.toLowerCase();return d.filter(t=>{var p;return t.brinco.toLowerCase().includes(s)||((p=t.nome)==null?void 0:p.toLowerCase().includes(s))}).slice(0,50)},[d,m]),C=()=>{r.name.trim()&&(y({name:r.name,description:r.description,purpose:r.purpose,animalIds:r.animalIds,createdAt:new Date,status:"active"}),i({name:"",description:"",purpose:l.Pesagem,animalIds:[]}),c(!1))},k=s=>{i(t=>({...t,animalIds:t.animalIds.includes(s)?t.animalIds.filter(p=>p!==s):[...t.animalIds,s]}))},I=s=>d.find(t=>t.id===s),b={[l.Vacinacao]:"bg-red-600",[l.Vermifugacao]:"bg-orange-600",[l.Pesagem]:"bg-blue-600",[l.Venda]:"bg-green-600",[l.Desmame]:"bg-purple-600",[l.Confinamento]:"bg-yellow-600",[l.Exposicao]:"bg-pink-600",[l.Apartacao]:"bg-cyan-600",[l.Outros]:"bg-gray-600"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Lotes de Manejo"}),e.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-brand-primary-dark transition-colors",children:"+ Novo Lote"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-3",children:"Lotes Ativos"}),h.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum lote ativo"}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(s=>e.jsxs("div",{className:"bg-base-800 rounded-lg p-4 border border-base-700 hover:border-brand-primary transition-colors cursor-pointer",onClick:()=>x(s),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:s.name}),e.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 text-xs rounded-full text-white ${b[s.purpose]}`,children:s.purpose})]}),e.jsx("span",{className:"text-2xl font-bold text-brand-primary",children:s.animalIds.length})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-base-700 flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Criado em ",new Date(s.createdAt).toLocaleDateString("pt-BR")]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),g(s.id)},className:"text-xs px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Concluir"})]})]},s.id))})]}),u.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-3",children:"Recentemente Concluídos"}),e.jsx("div",{className:"space-y-2",children:u.map(s=>e.jsxs("div",{className:"bg-base-800/50 rounded-lg px-4 py-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white",children:s.name}),e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",s.animalIds.length," animais)"]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:s.completedAt&&new Date(s.completedAt).toLocaleDateString("pt-BR")})]},s.id))})]}),e.jsx(j,{isOpen:f,onClose:()=>c(!1),title:"Criar Novo Lote",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Nome do Lote *"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>i(t=>({...t,name:s.target.value})),placeholder:"Ex: Vacinação Aftosa Março/2025",className:"w-full px-3 py-2 bg-base-700 border border-base-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Finalidade"}),e.jsx("select",{value:r.purpose,onChange:s=>i(t=>({...t,purpose:s.target.value})),className:"w-full px-3 py-2 bg-base-700 border border-base-600 rounded-lg text-white",children:Object.values(l).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Descrição"}),e.jsx("textarea",{value:r.description,onChange:s=>i(t=>({...t,description:s.target.value})),placeholder:"Observações opcionais...",className:"w-full px-3 py-2 bg-base-700 border border-base-600 rounded-lg text-white resize-none",rows:2})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Animais (",r.animalIds.length," selecionados)"]}),e.jsx("input",{type:"text",value:m,onChange:s=>v(s.target.value),placeholder:"Buscar por brinco ou nome...",className:"w-full px-3 py-2 bg-base-700 border border-base-600 rounded-lg text-white mb-2"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 bg-base-900 rounded-lg p-2",children:w.map(s=>e.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${r.animalIds.includes(s.id)?"bg-brand-primary/20 border border-brand-primary":"hover:bg-base-700"}`,children:[e.jsx("input",{type:"checkbox",checked:r.animalIds.includes(s.id),onChange:()=>k(s.id),className:"rounded"}),e.jsx("span",{className:"text-white text-sm",children:s.brinco}),s.nome&&e.jsxs("span",{className:"text-gray-400 text-xs",children:["(",s.nome,")"]}),e.jsxs("span",{className:"text-gray-500 text-xs ml-auto",children:[s.pesoKg,"kg"]})]},s.id))})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 px-4 py-2 bg-base-700 text-white rounded-lg hover:bg-base-600",children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:!r.name.trim(),className:"flex-1 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-brand-primary-dark disabled:opacity-50",children:"Criar Lote"})]})]})}),e.jsx(j,{isOpen:!!a,onClose:()=>x(null),title:(a==null?void 0:a.name)||"Detalhes do Lote",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full text-white ${b[a.purpose]}`,children:a.purpose}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[a.animalIds.length," animais"]})]}),a.description&&e.jsx("p",{className:"text-gray-300",children:a.description}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Animais no Lote"}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1",children:a.animalIds.map(s=>{const t=I(s);return t?e.jsxs("div",{className:"flex justify-between items-center p-2 bg-base-700 rounded",children:[e.jsx("span",{className:"text-white",children:t.brinco}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[t.pesoKg,"kg"]})]},s):null})})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{onClick:()=>{N(a.id),x(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Excluir"}),e.jsx("button",{onClick:()=>{g(a.id),x(null)},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Marcar como Concluído"})]})]})})]})};export{D as default};
